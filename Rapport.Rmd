---
title: "Analyse des d√©terminants de la testost√©rone"
author: "Maxime HERVE"
date: "2025-05-26"
output: html_document
---
### Introduction: 

La testost√©rone est une hormone cl√© du syst√®me endocrinien masculin, jouant un r√¥le central dans la r√©gulation de la masse musculaire, de la densit√© osseuse, de la libido, ainsi que dans diverses fonctions m√©taboliques (*Matsumoto, 2013*). Le d√©clin progressif des taux de testost√©rone avec l‚Äô√¢ge est bien document√© et associ√© √† plusieurs comorbidit√©s, notamment l‚Äôob√©sit√©, les troubles m√©taboliques et cardiovasculaires (*Kaufman & Vermeulen, 2005*).

Dans cette √©tude, nous avons s√©lectionn√© un ensemble de variables physiologiques et li√©es au mode de vie pour mieux comprendre leurs liens avec la testost√©rone totale. Parmi celles-ci, l‚Äô√¢ge et les mesures anthropom√©triques telles que le tour de taille sont int√©gr√©es en raison de leur forte corr√©lation avec la masse grasse visc√©rale, un facteur reconnu d‚Äôalt√©ration hormonale (*Grossmann et al., 2013*). Par ailleurs, la prot√©ine liant les hormones sexuelles (SHBG: sex hormone-binding globulin) est incluse, car elle influence la biodisponibilit√© de la testost√©rone et son activit√© biologique (*Rosner et al., 2007*).

Des param√®tres biochimiques comme le cholest√©rol HDL et l‚Äôalbumine sont √©galement pris en compte, en raison de leur r√¥le dans le transport hormonal et leur potentiel impact sur l‚Äô√©tat m√©tabolique g√©n√©ral (*Feldman et al., 2002*). Cette approche multifactorielle permet d‚Äôexplorer les d√©terminants majeurs de la testost√©rone tout en tenant compte des interactions complexes entre facteurs biologiques et environnementaux.


### Les variables:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
library(sandwich)
library(lmtest)
library(broom)
library(gtsummary)
library(dplyr)
library(ResourceSelection)
library(pROC)

invisible(capture.output(suppressWarnings(suppressMessages(source("Etude_testosterone.R"))), type = "output"))

# üìä STATISTIQUES DESCRIPTIVES

#----------Moyenne et m√©diane sur toutes les variables:----------

knitr::kable(summary_stats, digits = 2, caption = "R√©sultats:") %>%
  kableExtra::kable_styling(full_width = FALSE)
cat("Nombre d'observations :", nrow(vars_num), "\n", "Nombre de varaibles :", ncol(vars_num), "\n")

```
**Description de l'√©chantillon:**

L‚Äô√©chantillon est compos√© de 20 colonnes num√©riques mesur√©es sur 2623 individus issus du cycle NANHES de 2013 √† 2016 inclus, couvrant des domaines vari√©s : √¢ge, activit√© physique, alimentation, sommeil, composition corporelle, bilans biologiques, et notre variable principale la testost√©rone.
L‚Äô√¢ge moyen est de 43,6 ans, avec un IMC moyen de 28,7 kg/m¬≤, indiquant une tendance au surpoids. Le taux moyen de testost√©rone est de 420,8 ng/dL (√©cart-type : 158,4), avec des valeurs comprises entre 107 et 1050 ng/dL.
Le cholest√©rol HDL varie entre 22 et 99 mg/dL, pour une moyenne de 47,7 mg/dL.
On observe une large variabilit√© interindividuelle sur plusieurs variables, notamment la consommation d‚Äôalcool, la cotinine (nicotine), ou encore la dur√©e d‚Äôactivit√© assise.



### Tests de Shapiro-Wilk, de normalit√© de l‚Äô√¢ge et du taux de testost√©rone:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
#----------Croisement √¢ge / testost√©rone----------

# Tests de normalit√© de la r√©partition de l'age et du taux de testost√©rone
shapiro.test(dataset_final$RIDAGEYR)
shapiro.test(dataset_final$LBXTST)
```
**Hypoth√®ses:**

- **H0** : (hypoth√®se nulle) : La variable suit une distribution normale.(non rejet√© si p>0.05).
- **H1** : (hypoth√®se alternative) : La variable ne suit pas une distribution normale.

Les tests de normalit√© de Shapiro-Wilk appliqu√©s aux variables √¢ge `RIDAGEYR` et taux de testost√©rone `LBXTST` indiquent tous deux des r√©sultats significatifs avec des *p-values* tr√®s inf√©rieures au seuil de 0,05 (p < 2.2e-16).  
Cela signifie que la distribution de ces deux variables s‚Äô√©carte fortement d‚Äôune distribution normale.  

> *Note : ce r√©sultat justifie l‚Äôutilisation de m√©thodes statistiques non param√©triques, comme le test de corr√©lation de Spearman, pour analyser la relation entre √¢ge et testost√©rone.*




### Graphique du taux de testost√©rone moyen selon l'age:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
# Graphique moyenne testost√©rone en fonction de l'√¢ge avec moyenne mobile
ggplot(mean_testo_age, aes(x = RIDAGEYR)) +
  geom_line(aes(y = moyenne_testo), color = "blue", size = 1) + #Trace une courbe bleue repr√©sentant le taux moyen de testost√©rone selon l‚Äô√¢ge.
  geom_point(aes(y = moyenne_testo), color = "darkblue") + #Ajoute des points fonc√©s (bleu fonc√©) sur chaque observation de la courbe bleue
  geom_line(aes(y = moyenne_mobile), color = "green", size = 1, linetype = "solid") + #Ajoute une courbe verte repr√©sentant la moyenne mobile du taux de testost√©rone
  labs(
    x = "√Çge (ann√©es)",
    y = "Taux moyen de testost√©rone (ng/dL)",
    title = "√âvolution moyenne de la testost√©rone selon l'√¢ge",
    subtitle = "Ligne verte : moyenne mobile (k=3)"
  ) +
  theme_minimal()
```
**Interpr√©tations:**

La testost√©rone moyenne suit une tendance globale √† la baisse avec l‚Äô√¢ge en passant d'un pic moyen de 510 ng/dL √† l'age de 21 ans √† moins de 400 ng/dL √† l'age de 70 ans. Mais cette diminution **n‚Äôest pas lin√©aire**.  
On observe des **phases de stabilisation ou de r√©hausse ponctuelle** notamment √† la fin de la trentaine, qui peuvent √™tre influenc√©es par des facteurs comportementaux ou contextuels: comme un meilleur contr√¥le du mode de vie √† cet √¢ge : stabilisation familiale, meilleures habitudes (sommeil, alimentation, activit√© physique).


### Test de corr√©lation entre √¢ge et testost√©rone (Spearman):
```{r, echo = FALSE, warning=FALSE, message = FALSE}

# Test de corr√©laton de Spearman:
cor.test(dataset_final$RIDAGEYR, dataset_final$LBXTST, method = "spearman")
```

Le test de Spearman est un test non param√©trique utilis√© pour mesurer la force et la direction d‚Äôune association monotone entre deux variables num√©riques continues ou ordinales. Pas besoin de normalit√© sur les deux variables.

**Hypoth√®ses**:

- **H0** : Il n‚Äôy a aucune corr√©lation monotone entre les deux variables (le coefficient de Spearman est nul, œÅ = 0).
- **H1** : Il existe une corr√©lation monotone significative entre les deux variables (œÅ ‚â† 0).

Le coefficient de corr√©lation de Spearman entre l‚Äô√¢ge et le taux de testost√©rone est de **-0,135** et **p < 0,001**, indiquant une **faible association n√©gative statistiquement significative**.  
Cela sugg√®re que le taux de testost√©rone tend √† diminuer l√©g√®rement avec l‚Äô√¢ge.  

> *Note : la pr√©sence de valeurs identiques dans les donn√©es emp√™che le calcul exact de la p-value, mais le r√©sultat reste fiable.*


### Analyse du graphique entre la testost√©rone en fonction du HDL:
```{r, echo = FALSE, warning = FALSE, message = FALSE}
#------------- Croisemment cholesterol HDL / Testost√©rone -------------

ggplot(dataset_final, aes(x = LBDHDD, y = LBXTST)) +
  stat_density2d(aes(fill = ..level..), geom = "polygon") + #Ajoute une estimation de densit√© bidimensionnelle
  scale_fill_viridis_c() + geom_smooth(method = "lm", se = FALSE) + # Applique une palette de couleurs viridis et Superpose une droite de r√©gression lin√©aire
  labs(x = labels["LBDHDD"], 
       y = labels["LBXTST"],
       title = paste("Taux de", labels["LBXTST"], "en fonction du", labels["LBDHDD"]))
```

- Les couleurs repr√©sentent la **densit√© bivari√©s** de taux de cholesterol HDL et de testost√©rone. Plus la couleur est intense proche du jaune, plus il y a d'observations dans cette zone du graphique.
- La ligne bleue repr√©sente la **droite de r√©gression lin√©aire ajust√©e**.

**Tendance observ√©e :**

Une relation positive se d√©gage: plus le taux de bon cholesterol augmente, plus les bornes sup√©rieures et inf√©rieures des taux de testost√©rone ont tendance √† augmenter.
Cette relation semble globalement lin√©aire bien que la dispersion soit importante: les bornes de densit√© montrent une **forte variabilit√© intra groupe**.

**Bon √† savoir:**
Le taux de cholesterol HDL (lipoprot√©ines de haute densit√©), souvent appel√© "bon cholesterol", est mesure en mg/dL dans le sang. Les fourchettes g√©n√©ralement reconnues pour les adultes sont: entre 40 mg/dL et 60 mg/dL.
Un taux de HDL sup√©rieur ou √©gal √† 60 mg/dL est consid√©r√© comme protecteur contre les maladies cardiovasculaires (il faut √©viter de d√©passer les +100mg/dL), tandis qu'un taux inf√©rieur √† ces seuils est associ√© √† un risque accru.

***Interpr√©tations du graphique :***
Le pic de densite de du taux de cholesterol se situe entre 37 et 47 mg/dL environ, ce qui est trop peu. La population g√©n√©rale d'hommes am√©ricains semble √™tre en d√©ficite de bon cholesterol.
La **tendance lin√©aire croissante** entre le cholest√©rol HDL et la testost√©rone peut s‚Äôexpliquer par le r√¥le du cholest√©rol dans la **synth√®se hormonale**. De plus, un taux √©lev√© de HDL refl√®te souvent un bon √©tat m√©tabolique, favorable √† la production de l'hormone st√©ro√Ødienne*: √âtude de Freedman et al. (1991), √âtude de Stanworth et al. (2007).*
Cependant, un test de Spearman nous permettra de confirmer une √©ventuelle relation de corr√©lation entre ces deux variables.


### Interpr√©tation du test de corr√©lation de Spearman sur HDL:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
# Calcul de la corr√©lation de Spearman
cor.test(dataset_final$LBDHDD, dataset_final$LBXTST, method = "spearman")
```

- Le coefficient de corr√©lation de Spearman est **œÅ = 0.31**, ce qui indique une **corr√©lation positive mod√©r√©e** : quand le taux de HDL augmente, le taux de testost√©rone √† tendance √† augmenter.

- La p-value est faible : **p = 2.2e-16**, bien inf√©rieure √† un seuil classique (par exemple 0.05), ce qui signifie que cette corr√©lation positive est **statistiquement tr√®s significative**.

- On rejette l'hypoth√®se nulle et on conclut √† **une association monotone positive forte**: plus le taux de HDL est √©lev√©, plus le taux de testost√©rone a tendance √† √™tre haut. Cette association est robuste et peu probable d‚Äô√™tre due au hasard dans les donn√©es.


### Interpr√©tation du test de corr√©lation de Spearman sur la vitamine D:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
#---------------------Vit D / Testost√©rone -------------------------------------
cor.test(dataset_final$LBXVIDMS, dataset_final$LBXTST, method = "spearman")
```

Le coefficient de corr√©lation de Spearman est **œÅ = 0.032**, ce qui indique une corr√©lation positive tr√®s l√©g√®re voire quasi nulle entre le taux de vitamine D dans le sang et le taux de testost√©rone.

La p-value est √©lev√©e : **p = 0.1046**, bien sup√©rieur √† un seuil classique (par exemple 0.05), ce qui signifie que la corr√©lation n'est pas statistiquement significative.

On accepte l'hypoth√®se nulle et on conclut qu'il n'y a **aucune association entre le taux de testost√©rone et la vitamine D**.
D‚Äôun point de vue physiologique, certaines √©tudes (1) ont sugg√©r√© que la vitamine D pourrait influencer la production de testost√©rone via l‚Äôexpression du r√©cepteur de la vitamine D dans les cellules de Leydig (impliqu√©es dans la synth√®se des androg√®nes). Cependant, nos r√©sultats ne corroborent pas cette hypoth√®se, du moins dans la population √©tudi√©e ici. Il est possible que d'autres facteurs confondants (√¢ge, adiposit√©, statut inflammatoire...) masquent une relation sous-jacente.

(1): *: Association Between Vitamin D Deficiency and Testosterone Levels in Adult Males: A Systematic Review (Alexander Muacevic, John R Adler)*


### Analyse du graphique entre la testost√©rone et le tour de taille:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
#------------ Tour de taille (cm) / testost√©rone ----------

ggplot(dataset_final, aes(x = BMXWAIST, y = LBXTST)) + geom_point(shape = 21, color = "black", fill = "white",
                                                                  size = 2, stroke = 0.7) + geom_smooth(method = "lm", color="green") + labs( # cr√©er un nuage de points et courbe de r√©gression MLS (li√©aire simple)
  x = labels["BMXWAIST"],
  y = labels["LBXTST"],
  title = paste(labels["LBXTST"], "en fonction du", labels["BMXWAIST"])
)

```

Chaque point repr√©sente un individu, avec son **tour de taille (cm)** en abscisse et son **taux de testost√©rone (ng/dL)** en ordonn√©e.
La **ligne verte** repr√©sente la **droite de r√©gression lin√©aire** ajust√©e.

**Tendance observ√©e :**

Une **relation n√©gative claire** se d√©gage : plus le tour de taille est √©lev√©, plus le taux de testost√©rone tend √† diminuer.
Cette relation est **globalement lin√©aire**, bien que la dispersion soit importante.
Le nuage de points montre une **forte variabilit√© intra groupe**, mais la pente descendante de la droite indique une tendance g√©n√©rale coh√©rente.

**Interpr√©tation :**

Le graphique met en √©vidence une **corr√©lation n√©gative entre le tour de taille et la testost√©rone**.  
Autrement dit, les hommes ayant un **tour de taille plus √©lev√©** tendent √† avoir une **testost√©rone plus faible**.  
Ce r√©sultat est coh√©rent avec la litt√©rature scientifique, qui associe souvent **l‚Äôadiposit√© abdominale** √† une diminution du taux de testost√©rone. En effet, la graisse abdominale transformerais la testost√©rone en oestrog√®ne (hormone f√©minine) par le processus de l'aromatase d'apr√®s cette √©tude:
*Dhindsa et al., 2018 "Obesity is associated with hypogonadism and reduced testosterone in men".*
Une **analyse de r√©gression** incluant d'autres variables, permettrait de quantifier plus pr√©cis√©ment la **force de cette relation** (valeur du coefficient de corr√©lation, p-value, R¬≤...).


### Test de corr√©lation de Spearman entre le tour de taille et le taux de testost√©rone:
```{r, echo = FALSE, warning = FALSE, message = FALSE}
# Calcul de la corr√©lation de Spearman entre HDL et testost√©rone
cat("Corr√©lation de Spearman rho =", round(cor_test$estimate, 3), "\n", "p-value =", signif(cor_test$p.value, 3), "\n")
```

Le coefficient de corr√©lation de Spearman est œÅ = -0.428, ce qui indique une corr√©lation n√©gative mod√©r√©e : quand le tour de taille augmente, le taux de testost√©rone a tendance √† diminuer.

La p-value est extr√™mement faible (p = 1.8e-117), bien inf√©rieure √† un seuil classique (par exemple 0.05), ce qui signifie que cette corr√©lation n√©gative est statistiquement tr√®s significative.

On rejette l'hypoth√®se nulle et on conclut √† une association monotone n√©gative forte: 
Plus le tour de taille est √©lev√©, plus le taux de testost√©rone a tendance √† √™tre bas. Cette association est robuste et peu probable d‚Äô√™tre due au hasard dans les donn√©es.


### Analyse du graphique de bo√Øte √† moustache du temps de sommeil sur la testost√©rone:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
#------------ Croisement temps de sommeil / testost√©rone ----------

ggplot(testo_sommeil, aes(x = sleep_group, y = LBXTST)) +
  geom_boxplot(fill = "lightblue") + #cr√©ation d'un graphique de bo√Æte √† moustaches
  labs(x = "Temps de sommeil (heures)", y = "Testost√©rone (ng/dL)",
       title = "Testost√©rone selon groupes de sommeil")
```

Il semble exister une **l√©g√®re association positive** entre la dur√©e du sommeil et les niveaux moyens de testost√©rone, avec la **m√©diane de testost√©rone** (barre noire) qui semble l√©g√®rement **augmenter avec le temps de sommeil**, notamment entre les groupes <5h et >8h.  
Cependant, cette relation reste **peu marqu√©e visuellement**, et la **pr√©sence de nombreux outliers** sugg√®re une forte h√©t√©rog√©n√©it√© individuelle, et l‚Äô**amplitude des bo√Ætes** est relativement similaire, ce qui indique une dispersion comparable des valeurs dans chaque groupe.  
Une **analyse statistique compl√©mentaire (ANOVA)** est n√©cessaire pour conclure √† une √©ventuelle corr√©lation.


### Interpr√©tation du test ANOVA: corr√©lation entre testost√©rone et groupe de sommeil:
```{r, echo = FALSE, warning = FALSE, message = FALSE}
# test ANOVA corr√©lation sommeil et testo
anova_result <- aov(LBXTST ~ sleep_group, data = testo_sommeil)
summary(anova_result)

```

**Hypoth√®ses :**

- **H0** : Les moyennes de la testost√©rone sont √©gales dans tous les groupes de sommeil (p>0.05).
- **H1** : Au moins un groupe a une moyenne diff√©rente.

**R√©sultats :**

- La statistique F est **1.118**, ce qui n‚Äôest pas tr√®s √©lev√©.
- La *p-value* est **0.346**, donc bien sup√©rieure au seuil classique de 0.05.

**Conclusion :**

- On ne rejette pas l‚Äôhypoth√®se nulle (**H0**).  
- Autrement dit, il n‚Äôy a pas de diff√©rence statistiquement significative entre les groupes de temps de sommeil sur le taux moyen de testost√©rone.  
- Le temps de sommeil, tel que cat√©goris√© ici, ne semble pas influencer la testost√©rone de mani√®re d√©tectable avec cette ANOVA.


### Analyse du tableau de fr√©quence entre hypogonadisme et activit√© physique mod√©r√©e:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
#------------------activit√© physique / Hypogonadisme -----------------

# Puis CrossTable avec les nouvelles variables labellis√©es
CrossTable(dataset_final$hypogonadisme_lab, dataset_final$PAQ650_lab, prop.chisq=FALSE)
```

Nous remarquons que parmi les individus hypogonades qui repr√©sentent quasiment un quart de notre √©chantillon, 25,2% pratiquent une activit√© physique mod√©r√©e, contre 36,5% chez les non-hypogonades, soit une diff√©rence de plus de 10 points de pourcentage. Cette diff√©rence sugg√®re une association significative entre l‚Äôactivit√© physique mod√©r√©e et l‚Äôhypogonadisme.

Cependant, cette observation ne permet pas d‚Äôaffirmer une relation de causalit√© : il est tout aussi plausible que l‚Äôhypogonadisme r√©duise l‚Äôenvie ou la capacit√© √† pratiquer une activit√© physique, ou, qu‚Äôune absence d‚Äôactivit√© physique contribue √† une baisse des taux de testost√©rone. D‚Äôautres facteurs confondants (√¢ge, ob√©sit√©, sant√© g√©n√©rale‚Ä¶) pourraient √©galement jouer un r√¥le.

Une √©tude longitudinale ou exp√©rimentale serait n√©cessaire pour √©tablir un lien de cause √† effet, en plus d'un test de corr√©lation de Khi¬≤ entre nos deux variables.

### Test du Chi¬≤ de Pearson : test de corr√©lation entre activit√© physique mod√©r√©e et hypogonadisme:
```{r, echo = FALSE, warning=FALSE, message = FALSE}
# Test de khi¬≤ de corr√©lation entre activit√© physique mod√©r√©e et testo:

print(test_chi2)
```

**Hypoth√®ses :**

- **H0** : Il n‚Äôy a pas d‚Äôassociation entre l‚Äôhypogonadisme et la pratique d‚Äôactivit√© physique mod√©r√©e. Ces deux variables sont ind√©pendantes. (œá2 < 3.84 pour p. value > 0.05)
- **H1** : Il existe une association entre l‚Äôhypogonadisme et la pratique d‚Äôactivit√© physique mod√©r√©e. Ces variables sont d√©pendantes.

**R√©sultats :**

- Degr√©s de libert√© (df) : 1 (car tableau 2x2).
- La statistique du test : *œá2 = 26.274*. (au dessus de la valeur critique de 3.84 pour un seuil de 0.05)
- p-value: 2.96 x 10‚àí7 (tr√®s faible).

**Interpr√©tation et conclusion :**
La p-value est tr√®s inf√©rieure au seuil classique de 0.05, donc on rejette l‚Äôhypoth√®se nulle H0.
Cela signifie qu‚Äôil existe une association statistiquement significative entre la pr√©sence d‚Äôhypogonadisme et la pratique d‚Äôactivit√© physique mod√©r√©e dans ton √©chantillon.
Autrement dit, la proportion d‚Äôhommes avec hypogonadisme diff√®re significativement selon qu‚Äôils pratiquent ou non une activit√© physique mod√©r√©e.
Cette association peut s‚Äôexpliquer par le fait que l‚Äôhypogonadisme entra√Æne souvent une baisse d‚Äô√©nergie et de motivation, ce qui r√©duit la pratique d‚Äôactivit√© physique. Inversement, la pratique r√©guli√®re d‚Äôactivit√© physique pourrait contribuer √† maintenir des niveaux optimaux de testost√©rone, r√©duisant ainsi le risque de d√©velopper un hypogonadisme.


### Croisement entre oestradiol et testost√©rone :

```{r, echo = FALSE, warning=FALSE, message = FALSE}
#-------------------Taux estradiol / Hypogonadisme-------------------
ggplot(dataset_final, aes(x = LBXEST, fill = factor(hypogonadisme))) +
  geom_density(alpha = 0.5) + # Trace des courbes de densit√© pour la distribution du taux d'≈ìstradiol, `alpha = 0.5` rend les courbes semi-transparentes pour voir les recouvrement
  labs(x = labels["LBXEST"], # Nom personnalis√© pour l'axe des x (taux d'≈ìstradiol)
       fill = "Hypogonadisme", # L√©gende de la couleur (cat√©gories d‚Äôhypogonadisme)
       title = "Densit√© du taux d'≈ìstradiol selon l'hypogonadisme") + # Titre du graphique
  theme_minimal()
```

Il est int√©ressant de croiser l'hypogonadisme et l'oestradiol: des taux anormalement bas d‚Äô≈ìstradiol chez les hommes peuvent √™tre le reflet indirect d‚Äôun d√©ficit en testost√©rone, comme c‚Äôest souvent le cas dans le cadre d‚Äôun hypogonadisme. Inversement, des taux relativement √©lev√©s d‚Äô≈ìstradiol dans un contexte de faible testost√©rone peuvent aussi √©voquer un d√©s√©quilibre m√©tabolique ou une activit√© aromatasique excessive, parfois observ√©e dans certaines conditions comme l‚Äôob√©sit√© ou le vieillissement.

**Description:**
Ce graphique montre la distribution d'oestradiol en pg/mL pour deux groupes : les individus hypogonades et ceux non hypogonades. L‚Äôaxe horizontal indique les niveaux d‚Äô≈ìstradiol mesur√©s dans le sang, tandis que l‚Äôaxe vertical repr√©sente la densit√© de probabilit√© (et non le nombre brut d‚Äôindividus).

**Tendance observ√©e :**

Les hommes non hypogonades tendent √† avoir des taux d‚Äô≈ìstradiol plus √©lev√©s que ceux qui sont hypogonades.

**Interpr√©tation :**

Le graphique de densit√© montre que les hommes hypogonades pr√©sentent une distribution d‚Äô≈ìstradiol d√©plac√©e vers les valeurs plus faibles, par rapport aux non hypogonades.
Cela soutient l'id√©e qu'un taux r√©duit de testost√©rone est souvent accompagn√© d‚Äôun taux r√©duit d‚Äô≈ìstradiol: *√©tude: Rochira et al. (2006)*, ce qui est coh√©rent avec la physiologie endocrinienne masculine.
On peut confirmer statistiquement cette diff√©rence par un test de Wilcoxon.


#### Test de Wilcoxon (rang-somme de Mann-Whitney) pour la relation entre hypogonadisme et taux d'oestradiol
```{r, echo = FALSE, warning = FALSE, message = FALSE}
# test de Wolcoxon pour tester la relation entre oestradiol et hypogonadisme
wilcox.test(LBXEST ~ hypogonadisme, data = dataset_final)
```

**Hypoth√®ses:**

- **H0 ** : La distribution du taux d‚Äô≈ìstradiol est identique dans les deux groupes. (p. value > 0.05)
- **H1 ** : Il existe une diff√©rence de localisation (m√©diane ou distribution globale) entre les deux groupes.

**R√©sultats:**
- **p-value < 2.2e-16 :** Extr√™ment faible, bien inf√©rieure au seuil de 0.05, on rejette H0.

**Interpr√©tation et conclusion:**
Il existe une diff√©rence statistiquement significative entre les distributions des taux d‚Äô≈ìstradiol chez les hommes hypogonades et non hypogonades. Plus pr√©cis√©ment, les hommes non hypogonades pr√©sentent des taux d‚Äô≈ìstradiol significativement plus √©lev√©s.
Cela s‚Äôexplique par le fait que l‚Äô≈ìstradiol est produit √† partir de la testost√©rone via l‚Äôaromatase. Ainsi, en cas d‚Äôhypogonadisme (faible testost√©rone), on observe aussi une r√©duction du taux d‚Äô≈ìstradiol, ce qui justifie les r√©sultats.


### Mdol√®le 1 (MCO) de l'effet du mode de vie sur les taux de testost√©rone.
```{r, echo = FALSE, warning=FALSE, message = FALSE}
# üßëüî¨ MODELES STATISTIQUES

# Mod√®le MCO sur le mode de vie
modele_mode_vie %>%
  tbl_regression(
    label = as.list(labels), # Utilise la liste 'labels' pour nommer les variables dans le tableau
    estimate_fun = ~style_sigfig(., digits = 2), # Formate les coefficients estim√©s avec 2 chiffres significatifs
    pvalue_fun = ~style_pvalue(., digits = 3),  # Formate les p-values avec 3 d√©cimales
    conf.int = TRUE,
  ) %>%
  add_significance_stars() %>%               # Ajoute les √©toiles
  modify_column_unhide(column = "ci") %>%    # Pour √™tre s√ªr d'afficher les IC
  modify_column_unhide(column = "p.value") %>% # Pour √™tre s√ªr d'afficher la p_value
  as_flex_table()

# Affichage du R¬≤ ajust√© et test de Fisher
f <- summary(modele_mode_vie)$fstatistic
pval_f <- pf(f[1], f[2], f[3], lower.tail = FALSE) # Calcul de la p-value associ√©e au test de Fisher (test global du mod√®le)
cat(
  "R¬≤ ajust√© :", round(summary(modele_mode_vie)$adj.r.squared, 3), "\n", "\n",   # Affiche le R¬≤ ajust√© du mod√®le, arrondi √† 3 d√©cimales
  "Test de Fisher : F(", f[2], ",", f[3], ") =", round(f[1], 2), "\n",   # Affiche la statistique F avec ses degr√©s de libert√©, arrondie √† 2 d√©cimales
  ", p. value =", format.pval(pval_f, digits = 3)  # Affiche la p-value du test de Fisher, format√©e avec 3 chiffres significatifs
)

# Test d'homosc√©dasticit√© (Breusch-Pagan)
bptest(modele_mode_vie)

# colin√©arit√©:
vif(modele_mode_vie)
```

**üìä Interpr√©tation des r√©sultats:**

Toutes les interpr√©tations sont faites au seuil de 1 %, en supposant que les autres variables restent constantes. Environ 30 % des variables incluses sont significatives.

üßì √Çge: Une augmentation de 10 ans entra√Æne une baisse moyenne de pr√®s de 10 ng/dL de testost√©rone totale, en accord avec la litt√©rature indiquant une diminution annuelle de 1 √† 2 % apr√®s 30 ans, variable selon populations et m√©thodes.

üèÉ‚Äç‚ôÇÔ∏è Activit√© physique mod√©r√©e: La pratique d‚Äôune activit√© physique mod√©r√©e augmente la testost√©rone de 26 ng/dL en moyenne. Ce r√©sultat robuste confirme l‚Äôeffet positif global de l‚Äôactivit√© physique sur la production hormonale, m√™me si l‚Äôeffet d√©pend du type, de la dur√©e et de la r√©gularit√© de l‚Äôeffort.

ü™ë Dur√©e d‚Äôactivit√© assise: Chaque minute pass√©e assise diminue la testost√©rone de 0.05 ng/dL, soit environ 24 ng/dL pour une journ√©e de 8 heures assis. Ce r√©sultat rejoint *Park et al. (2019)* qui associent la s√©dentarit√© √† une baisse hormonale via la r√©duction de l‚Äôactivit√© physique, la prise de poids et l‚Äôinflammation. Ainsi, l'activit√© physique mod√©r√©e permet de compenser les m√©faits de la s√©dentarit√© sur la testost√©rone.

**‚ö†Ô∏è Variables non significatives:**
Certaines variables attendues comme le sommeil ne sont pas significatives ici, contrairement √† la litt√©rature (*Leproult & Van Cauter, 2011*), qui montre une baisse notable de la testost√©rone apr√®s privation de sommeil. De m√™me, la consommation de sucres est positivement associ√©e √† la testost√©rone (+0.15 ng/dL/g), ce qui contraste avec les √©tudes liant sucres excessifs √† une baisse hormonale (*Hussein et al., 2017*). Une hypoth√®se est qu‚Äôun apport mod√©r√© en glucides soutient la production d‚Äô√©nergie n√©cessaire au syst√®me endocrinien.


**üìà Qualit√© globale du mod√®le:**

üî¨ Test de Fisher:

- H‚ÇÄ : aucune variable n‚Äôa d‚Äôeffet significatif.
- H‚ÇÅ : au moins une variable a un effet significatif.

Le test de Fisher est significatif (p < 0.001), indiquant que le mod√®le global pr√©dit significativement la testost√©rone, avec au moins une variable explicative importante.

üìâ R¬≤ ajust√©
Le R¬≤ ajust√© est faible (0.025), signifiant que seulement 2,5 % de la variance de la testost√©rone est expliqu√©e. Cela s‚Äôexplique par :

La complexit√© des facteurs influen√ßant la testost√©rone (√©tat psychologique, pathologies, hormones r√©gulatrices comme LH, FSH, GnRH).

Une forte variabilit√© individuelle li√©e aux cycles circadiens, au stress, etc.

La possible pr√©sence d‚Äôeffets non lin√©aires ou d‚Äôinteractions non mod√©lis√©es.

üß™ Test d‚Äôhomosc√©dasticit√©:
Le test de Breusch-Pagan a √©t√© effectu√© pour √©valuer l‚Äôhomosc√©dasticit√© des r√©sidus du mod√®le. Avec une statistique BP = 12.097 sur 10 degr√©s de libert√© et une p-value de 0.279, nous ne rejetons pas l‚Äôhypoth√®se nulle d‚Äôhomosc√©dasticit√©. Cela sugg√®re que la variance des termes d‚Äôerreur est constante √† travers les valeurs pr√©dites, validant ainsi l‚Äôune des hypoth√®ses cl√©s du mod√®le lin√©aire classique, et assurant la fiabilit√© des intervalles de confiance et des tests de significativit√© des coefficients.

‚öñÔ∏è V√©rification de la multicolin√©arit√©:
Les facteurs d'inflation de la variance (VIF) calcul√©s pour les variables du mod√®le varient entre 1.008 et 3.674. Tous ces valeurs sont bien en dessous du seuil commun√©ment accept√© de 5 (voire 10), indiquant une faible colin√©arit√© entre les variables explicatives. Ainsi, aucune variable ne semble redondante ou fortement corr√©l√©e √† une autre, ce qui garantit la stabilit√© et la fiabilit√© des estimations des coefficients du mod√®le.

**üîç Conclusion et perspectives:**
Ce mod√®le confirme que l‚Äô√¢ge, l‚Äôactivit√© physique mod√©r√©e et la s√©dentarit√© influencent significativement le taux de testost√©rone. Malgr√© un R¬≤ ajust√© faible (2,5 %), ces r√©sultats soulignent l‚Äôimportance du mode de vie sur la sant√© hormonale.

Pour am√©liorer la compr√©hension, il serait utile d‚Äôint√©grer d‚Äôautres facteurs biologiques (hormones r√©gulatrices, √©tat psychologique) et environnementaux, ainsi que d‚Äôexplorer des mod√®les plus complexes.

Ces r√©sultats encouragent √† promouvoir l‚Äôactivit√© physique et √† limiter la s√©dentarit√© comme leviers simples pour soutenir la testost√©rone naturellement.

### Mdol√®le 2 (MCO) mod√®le physiologique de l'effet des indicateurs biologiques sur les niveaux de testost√©rone.
```{r, echo = FALSE, warning=FALSE, message = FALSE}

# Mod√®le MCO sur les indicateurs biologiques
modele_physiologique %>%
  tbl_regression(
    label = as.list(labels),
    estimate_fun = ~style_sigfig(., digits = 2),
    pvalue_fun = ~style_pvalue(., digits = 3),
    conf.int = TRUE,
  ) %>%
  add_significance_stars() %>%               # Ajoute les √©toiles
  modify_column_unhide(column = "ci") %>%    # Pour √™tre s√ªr d'afficher les IC
  modify_column_unhide(column = "p.value") %>% # Pour √™tre s√ªr d'afficher la p_value
  as_flex_table()

# Affichage du R¬≤ ajust√© et test de Fisher
f <- summary(modele_physiologique)$fstatistic
pval_f <- pf(f[1], f[2], f[3], lower.tail = FALSE)
cat(
  "R¬≤ ajust√© :", round(summary(modele_physiologique)$adj.r.squared, 3), "\n", "\n",
  "Test de Fisher : F(", f[2], ",", f[3], ") =", round(f[1], 2), "\n",
  ", p. value =", format.pval(pval_f, digits = 3)
)

# Test d'homosc√©dasticit√© (Breusch-Pagan)
bptest(modele_physiologique)

# colin√©arit√©:
vif(modele_physiologique)
```

**üìä Interpr√©tation des r√©sultats:**

Toutes les interpr√©tations sont faites au seuil de 1 %, en supposant que les autres variables restent constantes. Environ 30 % des variables incluses sont significatives.

üìè Tour de taille : Chaque centim√®tre suppl√©mentaire de tour de taille r√©duit significativement la testost√©rone de 2.3 ng/dL (p < 0.001). Cela souligne l‚Äôeffet n√©gatif de l‚Äôadiposit√© abdominale, souvent associ√©e √† la r√©sistance √† l‚Äôinsuline et √† une inflammation chronique qui peut perturber la synth√®se hormonale (*Corona et al., 2013*), voire √† l'aromatase. Cela confirme bien notre statistique descriptive.

üîó SHBG (Sex Hormone Binding Globulin) : L‚Äôaugmentation de SHBG est fortement corr√©l√©e √† une hausse du taux de testost√©rone (5.3 ng/dL par unit√©, p < 0.001). SHBG module la disponibilit√© des hormones sexuelles ; son augmentation peut refl√©ter une meilleure r√©gulation hormonale (*Rosner et al., 2013*). Ou bien, une difficult√© √† rendre la testost√©rone disponible dans l'organiste car trop li√©e √† la SHBG, ce qui aurait pour effet de la garder stocker et indisponible dans le sang, augmentant ainsi le taux de testost√©rone totale : *Mohr et al., 2005 ‚Äì ‚ÄúNormal, bound and bioavailable testosterone in aging men*.

üíô Cholest√©rol HDL : Un effet positif significatif est observ√©, avec une augmentation de 0.78 ng/dL par mg/dL de HDL (p < 0.001). Ce lien peut s‚Äôexpliquer par le r√¥le protecteur du HDL sur le m√©tabolisme lipidique et endocrinien, favorisant une meilleure production hormonale (*Haring et al., 2011*).

ü©∏ Albumine : L‚Äôalbumine, une prot√©ine de transport sanguine, est √©galement positivement associ√©e √† la testost√©rone (2.6 ng/dL, p = 0.007), ce qui est coh√©rent avec son r√¥le dans le transport et la biodisponibilit√© hormonale (*Morgentaler, 2015*).

**üìä‚ú® R√©sum√© statistique du mod√®le :**

Le mod√®le explique 52 % de la variance du taux de testost√©rone totale (R¬≤ ajust√© = 0.52), ce qui indique un pouvoir explicatif substantiel. Le test de Fisher est hautement significatif (F = 190.59, p < 2e-16), confirmant que l‚Äôensemble des variables incluses contribue significativement √† la pr√©diction du taux de testost√©rone.

**üß™ Test d‚Äôhomosc√©dasticit√© de Breusch-Pagan :**

Le test de Breusch-Pagan appliqu√© √† notre mod√®le physiologique r√©v√®le une valeur de BP = 189.65, avec 15 degr√©s de libert√© et une p-value < 2.2e-16.

Cela indique une h√©t√©rosc√©dasticit√© significative : la variance des r√©sidus n‚Äôest pas constante √† travers les niveaux des pr√©dicteurs.
Autrement dit, l'hypoth√®se d‚Äôhomosc√©dasticit√© est rejet√©e, ce qui viole un des postulats fondamentaux de la r√©gression lin√©aire.

Cons√©quences :

- Les erreurs standards peuvent √™tre biais√©es, affectant la fiabilit√© des tests statistiques.
- Les coefficients restent non biais√©s, mais les valeurs de p peuvent √™tre trompeuses.

**üîç Conclusion du mod√®le physiologique:**

Ce mod√®le explique environ 52 % de la variance du taux de testost√©rone totale, ce qui est un pouvoir explicatif nettement sup√©rieur √† notre mod√®le pr√©c√©dent. Le test de Fisher confirme que l‚Äôensemble des variables incluses a un effet significatif sur la testost√©rone (p < 2.2e-16).

Cependant, la d√©tection d‚Äôune h√©t√©rosc√©dasticit√© forte via le test de Breusch-Pagan sugg√®re que la variance des erreurs n‚Äôest pas constante, ce qui peut biaiser nos int ervalles de confiance et tests de significativit√©. Pour renforcer la robustesse des conclusions, il serait pertinent d‚Äôajuster le mod√®le avec des erreurs robustes.

### R√©sum√© des r√©sultats avec erreurs robustes du mod√®le physiologique
```{r, echo = FALSE, warning=FALSE, message = FALSE}
# R√©cup√©rer les noms exacts des coefficients (incluant modalit√©s)
coef_names <- names(coef(modele_physiologique))

# Associer chaque coefficient √† son label, sinon garder le nom original
labels_complete <- sapply(coef_names, function(x) {
  if (x %in% names(labels)) {
    labels[[x]]
  } else {
    x  # si label manquant, garder le nom de la variable brute
  }
})


# Calcul de la matrice de variance-covariance robuste HC3
cov_robust <- vcovHC(modele_physiologique, type = "HC3") #matrice de covariance robuste (de White)

# Coefficients et erreurs robustes
estimates <- coef(modele_physiologique)
robust_se <- sqrt(diag(cov_robust)) #Extraction des erreurs standards robustes

# Calcul des p-values robustes avec coeftest
robust_test <- coeftest(modele_physiologique, vcov = cov_robust) #R√©cup√©ration des coefficients estim√©s (valeurs des param√®tres) du mod√®le lin√©aire
p_values <- robust_test[, "Pr(>|t|)"]

# Calcul des intervalles de confiance √† 95%
z_crit <- qnorm(0.975)
lower <- estimates - z_crit * robust_se
upper <- estimates + z_crit * robust_se

# Puis cr√©er le tableau
resultats <- data.frame(
  Variable = labels_complete,
  Estimate = estimates,
  Robust_SE = robust_se,
  CI_lower = lower,
  CI_upper = upper,
  p_value = p_values,
  row.names = NULL
)

# Arrondir et afficher
resultats <- resultats %>%
  mutate(
    Estimate = round(Estimate, 2),
    Robust_SE = round(Robust_SE, 2),
    CI_lower = round(CI_lower, 2),
    CI_upper = round(CI_upper, 2),
    p_value = signif(p_value, 3)
  )

kable(resultats, caption = "Estimation des coefficients avec erreurs robustes HC3")


```

Une variable suppl√©mentaire semble significative:
L'albumine (Œ≤ = 2.56, p = 0.007) : L‚Äôalbumine, une prot√©ine de transport dans le sang, montre une association positive avec la testost√©rone totale: augmentation de 25.6 nd/dL de la testost√©rone totale quand le taux d'albumine dans le sang augmente de 10g. √âtant donn√© que l‚Äôalbumine transporte une partie de la testost√©rone li√©e, son r√¥le est attendu (*Vermeulen et al., 1999*). N√©anmoins, l‚Äôassociation peut aussi refl√©ter l‚Äô√©tat nutritionnel g√©n√©ral plut√¥t qu‚Äôun effet direct.



**Regard critique: **

Les larges intervalles de confiance pour certaines cat√©gories ethniques et les p-values proches du seuil invitent √† la prudence. L‚Äôassociation positive entre cholest√©rol HDL et testost√©rone totale m√©rite des √©tudes longitudinales pour clarifier la causalit√©.

L‚Äôeffet de l‚Äôalbumine doit √™tre interpr√©t√© avec soin, car seule la testost√©rone libre et la fraction li√©e faiblement √† l‚Äôalbumine sont biologiquement actives, contrairement √† la testost√©rone li√©e √† la SHBG.

Enfin, les associations n√©gatives avec l‚Äô√¢ge et le tour de taille confirment les r√©sultats de la litt√©rature sur l‚Äôimpact du vieillissement et du m√©tabolisme sur la testost√©rone.

Mettre en place un mod√®le logistique permet d‚Äô√©valuer la probabilit√© d‚Äôhypogonadisme (√©tat clinique d√©fini par un seuil critique de testost√©rone), plut√¥t que de se limiter √† l‚Äôanalyse continue de la testost√©rone totale. Cela facilite l‚Äôidentification des facteurs de risque cliniquement pertinents et l‚Äôaide √† la prise de d√©cision m√©dicale.

### Interpr√©tation du mod√®le logistique sur l‚Äôhypogonadisme
```{r, echo = FALSE, warning=FALSE, message = FALSE}

# Mod√®le logistique global
modele_logistique %>%
  tbl_regression(
    label = as.list(labels),
    estimate_fun = ~style_ratio(., digits = 2),   # Affiche OR avec 2 chiffres significatifs
    pvalue_fun = ~style_pvalue(., digits = 3),
    exponentiate = TRUE,                          # Affiche les coefficients exponenti√©s (OR)
    conf.level = 0.95                            # IC √† 95%
  ) %>%
  add_significance_stars() %>%                    # Ajoute √©toiles pour la p-value
  modify_column_unhide(column = "p.value") %>%    # Affiche la colonne p-value
  modify_column_unhide(column = "ci") %>%
  as_flex_table()

```

Les r√©sultats indiquent que parmi toutes les variables test√©es, seules l‚Äô√¢ge et le tour de taille ont un effet significatif sur la probabilit√© d‚Äôhypogonadisme, tandis que la SHBG pr√©sente un effet inverse significatif.

üßì √Çge (OR = 1.05, p < 0.001) : Pour chaque ann√©e suppl√©mentaire, les chances d‚Äôhypogonadisme augmentent de 5 %, ce qui est coh√©rent avec la litt√©rature montrant que la testost√©rone diminue naturellement avec l‚Äô√¢ge (*Harman et al., 2001*).

üìè Tour de taille (OR = 1.05, p < 0.001) : Une augmentation d‚Äôun centim√®tre du tour de taille accro√Æt la probabilit√© d‚Äôhypogonadisme de 5 %. Cela souligne le r√¥le de l‚Äôob√©sit√© abdominale dans la dysr√©gulation hormonale (*Corona et al., 2011*).

üîó SHBG (OR = 0.91, p < 0.001) : Chaque unit√© suppl√©mentaire de SHBG diminue de 9 % le risque d‚Äôhypogonadisme, ce qui correspond √† son r√¥le dans le transport et la disponibilit√© des hormones sexuelles (*Rosner et al., 2010*).

Les autres variables, notamment l‚ÄôIMC, les consommations alimentaires (calories, sucres, alcool, magn√©sium, zinc), l‚Äôactivit√© physique, les habitudes de sommeil et les marqueurs lipidiques, n‚Äôont pas montr√© d‚Äôassociation statistiquement significative.


**Limites et recommandations:**

Certaines variables non significatives pourraient avoir un effet faible ou n√©cessiter une plus grande taille d‚Äô√©chantillon.
Il est important de v√©rifier la multicolin√©arit√© entre variables, notamment tour de taille et IMC.
R√©aliser des tests compl√©mentaires comme Hosmer-Lemeshow pour l‚Äôajustement du mod√®le et une courbe ROC pour la performance pr√©dictive.
Consid√©rer d‚Äôajouter des interactions possibles entre variables.
V√©rifier la pertinence clinique des effets m√™me quand les OR sont proches de 1.

```{r, echo = FALSE, warning=FALSE, message = FALSE}
# Test de Hosmer-Lemeshow : Ajustement global du mod√®le
hoslem.test(
  x = dataset_final$hypogonadisme,
  y = fitted(modele_logistique),
  g = 10  # nombre de groupes pour les d√©ciles de risque, 10 est courant
)

# Courbe ROC et AUC pour √©valuer la discrimination du mod√®le
roc_obj <- roc(dataset_final$hypogonadisme, fitted(modele_logistique))
plot(roc_obj)
auc(roc_obj)

```
**Hypoth√®ses et interpr√©tations du test de Hosmer-Lemeshow :**

- **H0 ** : Le mod√®le logistique s‚Äôajuste correctement aux donn√©es (pas de diff√©rence significative entre les probabilit√©s pr√©dites et les observations r√©elles dans les sous-groupes) (p. value > 0.05).
- **H1 ** : Le mod√®le ne s‚Äôajuste pas bien aux donn√©es.


**üìå Conclusion :**
Avec une p-value tr√®s faible (p < 0.05), on rejette H‚ÇÄ. Cela indique qu'il existe une diff√©rence significative entre les valeurs observ√©es et les valeurs attendues. Le mod√®le logistique pourrait ne pas √™tre bien calibr√©, c‚Äôest-√†-dire que les probabilit√©s pr√©dites ne correspondent pas bien aux probabilit√©s r√©elles dans certains sous-groupes de risque.

**‚úÖCourbe ROC ‚Äì Interpr√©tation de l‚ÄôAUC:**

- AUC = 0.8387

Cela signifie que le mod√®le a une bonne capacit√© discriminante. 

> *Note: Si l'on prend au hasard un individu avec hypogonadisme et un sans, le mod√®le a 83.9 % de chances d‚Äôattribuer un score de probabilit√© plus √©lev√© √† la personne atteinte qu‚Äô√† la personne non atteinte.*

**üß† Conclusion: ** Le mod√®le discrimine correctement les individus √† risque et peut √™tre utilis√©, mm√™me si l'ajustement est √† am√©liorer pour mieux pr√©dire les probas extactes.


### üßæ Conclusion g√©n√©rale:

Cette √©tude met en √©vidence plusieurs facteurs significativement associ√©s aux niveaux de testost√©rone totale chez les hommes, en particulier l‚Äô√¢ge, la SHBG et le tour de taille. Les r√©sultats confirment des liens d√©j√† √©tablis dans la litt√©rature entre mode de vie, m√©tabolisme et √©quilibre hormonal. Malgr√© un pouvoir explicatif limit√© du mod√®le lin√©aire, le mod√®le logistique pr√©sente de bonnes performances discriminantes (AUC = 0.84). Ces analyses pourraient contribuer √† mieux cibler les populations √† risque d‚Äôhypogonadisme dans une perspective de sant√© publique.